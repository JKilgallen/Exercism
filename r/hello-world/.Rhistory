fit1 <- lm(y~x1+x2+x1*x2, data=data1)
fit2 <- lm(y~sqr_x1+x2+sqr_x1*x2, data=data1)
residualPlots(fit1,ylab="Residuals", tests=T)
residualPlots(fit2,ylab="Residuals", tests=T)
data1$sqr_x1 <- x**2
data1$sqr_x1 <- x1**2
data1$cube_x2 <- x2**3
fit1 <- lm(y~x1+x2+x1*x2, data=data1)
fit2 <- lm(y~sqr_x1+cube_x2+sqr_x1*cube_x2, data=data1)
residualPlots(fit2,ylab="Residuals", tests=T)
x1=c(-4,-3,-2,-1,0,1,2,3,4,5,6,-5,-6,-7,-8)
x2=c(-4,0,3,-7,2,-3,7,-6,5,-2,-5,-1,1,6,8)
y=c(-30,20,35,-340,10,-25,350,-200,160,40,-52,50,75,315,640)
data1=data.frame(x1,x2,y)
data1$cube_x1 <- x1**3
data1$sqr_x2 <- x2**2
fit1 <- lm(y~x1+x2+x1*x2, data=data1)
fit2 <- lm(y~cube_x1+sqr_x2+cube_x1*sqr_x2, data=data1)
residualPlots(fit2,ylab="Residuals", tests=T)
summary(fit2)
fit2 <- lm(y~cube_x1+sqr_x2, data=data1)
summary(fit2)
data1$cube_x1 <- x2**3
data1$sqr_x2 <- x1**2
fit1 <- lm(y~x1+x2+x1*x2, data=data1)
fit2 <- lm(y~cube_x1+sqr_x2+cube_x1*sqr_x2, data=data1)
summary(fit2)
residualPlots(fit2,ylab="Residuals", tests=T)
residualPlots(fit2,ylab="Residuals", tests=T)
residualPlots(fit1,ylab="Residuals", tests=T)
fit2 <- lm(y~cube_x1+sqr_x2, data=data1)
summary(fit2)
+cube_x1*sqr_x2
fit2 <- lm(y~cube_x1+sqr_x2+cube_x1*sqr_x2, data=data1)
summary(fit2)
residualPlots(fit2,ylab="Residuals", tests=T)
summary(fit2)
summary(fit2)
fit2 <- lm(y~cube_x1+sqr_x2, data=data1)
summary(fit2)
x1=c(0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9)
x2=c(0.3,0.5,0.7,0.1,0.6,0.8,0,0.9,0.4,0.2)
y=c(58,40,25,50,25,18,40,15,22,24)
ex2.data=data.frame(x1,x2,y)
data2=data.frame(x1,x2,y)
fit3 <- lm(y~x1+x2+x1*x2, data=data2)
summary(fit3)
residualPlots(fit3,ylab="Residuals", tests=F)
residualPlots(fit3,ylab="Residuals", tests=F)
bcfit3 <- boxCox(fit3)
x1=c(0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9)
x2=c(0.3,0.5,0.7,0.1,0.6,0.8,0,0.9,0.4,0.2)
y=c(58,40,25,50,25,18,40,15,22,24)
data2=data.frame(x1,x2,y)
fit3 <- lm(y~x1+x2+x1*x2, data=data2)
summary(fit3)
residualPlots(fit3,ylab="Residuals", tests=F)
library(car)
residualPlots(fit3,ylab="Residuals", tests=F)
bcfit3 <- boxCox(fit3)
bcfit3$x[which.max(bcfit3$y)]
fit4 <- lm(y^-0.25~x1+x2, data=data2)
summary(fit4)
residualPlots(fit4,ylab="Residuals", tests=F)
x1=c(-4,-3,-2,-1,0,1,2,3,4,5,6,-5,-6,-7,-8)
x2=c(-4,0,3,-7,2,-3,7,-6,5,-2,-5,-1,1,6,8)
y=c(-30,20,35,-340,10,-25,350,-200,160,40,-52,50,75,315,640)
data1=data.frame(x1,x2,y)
data1$cube_x1 <- x2**3
data1$sqr_x2 <- x1**2
fit1 <- lm(y~x1+x2+x1*x2, data=data1)
fit2 <- lm(y~cube_x1+sqr_x2, data=data1)
crPlots(fit2)
summary(fit4)
summary(fit4)
residualPlots(fit4,ylab="Residuals", tests=F)
qf(0.95,df1=2,df2=82)
?qt
qt(0.95,86)
pt(-3.0975,df=86)
2*pt(-3.0975,df=86)
2*pt(-0.003704,df=86)
?qf
pf(0.09047,df1=2,df2=355)
qf(0.95,df1=2,df2=355)
pf(0.9047,df1=2,df2=355)
pf(9047,df1=2,df2=355)
qf(0.95,df1=2,df2=355)
pf(3.02,df1=2,df2=355)
pf(0.09,df1=2,df2=355)
pf(3.2,df1=2,df2=355)
2.84102-0.0956
0.002169+0.2733
2.84102+0.08163+0.1182
0.2733-0.002888
pf(0.09,df1=2,df2=355)
pf(3,df1=2,df2=355)
pf(0.1,df1=2,df2=355)
pf(0.05,df1=2,df2=355)
pf(0.005,df1=2,df2=355)
pf(0.00005,df1=2,df2=355)
pf(2,df1=2,df2=355)
pf(6.36,df1=2,df2=32)
?pt
pt(q=1.7889, df =420, lower.tail = FALSE)
?pz
pnorm(1.7889, lower.tail = FALSE)
pchisq(8.5418, 3, lower.tail = FALSE)
knitr::opts_chunk$set(echo = TRUE, fig.width=4, fig.height=4)
set.seed(2)
library(mlbench)
library(ggplot2)
library(class)
library(MASS)
data(PimaIndiansDiabetes2)
d <- na.omit(PimaIndiansDiabetes2)
set.seed(2)
s <- sample(nrow(d), round(.6*nrow(d)))
dtrain <- d[s,]
dtest<- d[-s,]
head(d)
plot(age~glucose, col = diabetes, data =d)
plot(age~glucose, col = diabetes, data =dtrain)
ggplot(data=dtrain, aes(x=age, y=glucose, color=diabetes) ) +
geom_point(alpha=.5)
f <- glm(diabetes~age+glucose, family = "binomial", data = dtrain)
summary(f)
f <- glm(diabetes~age+glucose, family = "binomial", data = dtrain)
ggplot(data=dtrain, aes(x=age, y=glucose)) +
geom_point(aes(color=diabetes),alpha=.5)+
geom_contour(data=grid,aes(z=prob),breaks=.5, color="black")
ggplot(data=dtrain, aes(x=age, y=glucose)) +
geom_point(aes(color=diabetes),alpha=.5)+
geom_contour(data=dtrain,aes(z=prob),breaks=.5, color="black")
f <- glm(diabetes~age+glucose, family = "binomial", data = dtrain)
ggplot(data=dtrain, aes(x=age, y=glucose)) +
geom_point(aes(color=diabetes),alpha=.5)+
geom_contour(data=dtrain,aes(z=prob),breaks=.5, color="black")
summary(d)
f <- glm(diabetes~age+glucose, family = "binomial", data = dtrain)
grid <- expand.grid(
age = seq(0, 85, length = 100),
glucose = seq(50, 200, length = 100)
)
grid$prob <- predict(f, grid, type="response")
f <- glm(diabetes~age+glucose, family = "binomial", data = dtrain)
grid <- expand.grid(
age = seq(0, 85, length = 100),
glucose = seq(50, 200, length = 100)
)
grid$prob <- predict(f, grid, type="response")
ggplot(data=dtrain, aes(x=age, y=glucose)) +
geom_point(aes(color=diabetes),alpha=.5)+
geom_contour(data=dtrain,aes(z=prob),breaks=.5, color="black")
f <- glm(diabetes~age+glucose, family = "binomial", data = dtrain)
grid <- expand.grid(
age = seq(0, 85, length = 100),
glucose = seq(50, 200, length = 100)
)
grid$prob <- predict(f, grid, type="response")
ggplot(data=dtrain, aes(x=age, y=glucose)) +
geom_point(aes(color=diabetes),alpha=.5)+
geom_contour(data=grid,aes(z=prob),breaks=.5, color="black")
summary(f)
testpred <- predict(f, dtest, type=response)
testpred <- predict(f, dtest, type="response")
etabtest <- table(testpred, dtest[,1])
etabtest
prob <- predict(f, type="response")
pred <- factor(ifelse(prob < .5, "No", "Yes"))
pred <- factor(ifelse(prob < .5, "neg", "pos"))
table(Default$default, pred)
table(dtest$diabetes, pred)
table(d$diabetes, pred)
pred
summary(pred)
predict(f, type="response")
summary(predict(f, type="response"))
summary(f)
f <- glm(diabetes~age+glucose, family = "binomial", data = dtrain)
grid <- expand.grid(
age = seq(0, 85, length = 100),
glucose = seq(50, 200, length = 100)
)
grid$prob <- predict(f, grid, type="response")
ggplot(data=dtrain, aes(x=age, y=glucose)) +
geom_point(aes(color=diabetes),alpha=.5)+
geom_contour(data=grid,aes(z=prob),breaks=.5, color="black")
prob <- predict(f, type="response")
pred <- factor(ifelse(prob < .5, "neg", "pos"))
table(dtrain$diabetes, pred)
f <- glm(diabetes~age+glucose, family = "binomial", data = dtrain)
grid <- expand.grid(
age = seq(0, 85, length = 100),
glucose = seq(50, 200, length = 100)
)
grid$prob <- predict(f, grid, type="response")
ggplot(data=dtrain, aes(x=age, y=glucose)) +
geom_point(aes(color=diabetes),alpha=.5)+
geom_contour(data=grid,aes(z=prob),breaks=.5, color="black")
prob <- predict(f, type="response")
pred <- factor(ifelse(prob < .5, "neg", "pos"))
table(dtest$diabetes, pred)
?predict
?predict.glm
f <- glm(diabetes~age+glucose, family = "binomial", data = dtrain)
grid <- expand.grid(
age = seq(0, 85, length = 100),
glucose = seq(50, 200, length = 100)
)
grid$prob <- predict(f, grid, type="response")
ggplot(data=dtrain, aes(x=age, y=glucose)) +
geom_point(aes(color=diabetes),alpha=.5)+
geom_contour(data=grid,aes(z=prob),breaks=.5, color="black")
prob <- predict(f, newdata=dtest, type="response")
pred <- factor(ifelse(prob < .5, "neg", "pos"))
table(dtest$diabetes, pred)
head(dtrain)
f <- lda(diabetes~age+glucose,data=dtrain)
grid <- expand.grid(
age = seq(0, 85, length = 100),
glucose = seq(50, 200, length = 100)
)
grid$prob <- predict(f, grid)$posterior[,"pos"]
ggplot(data=dtrain, aes(x=age, y=glucose)) +
geom_point(aes(color=diabetes),alpha=.5)+
geom_contour(data=grid,aes(z=prob),breaks=.5, color="black")
f <- lda(diabetes~age+glucose,data=dtrain)
grid <- expand.grid(
age = seq(0, 85, length = 100),
glucose = seq(50, 200, length = 100)
)
grid$prob <- predict(f, grid)$posterior[,"pos"]
ggplot(data=dtrain, aes(x=age, y=glucose)) +
geom_point(aes(color=diabetes),alpha=.5)+
geom_contour(data=grid,aes(z=prob),breaks=.5, color="black")
prob <- predict(f, newdata=dtest, type="response")
pred <- factor(ifelse(prob < .5, "neg", "pos"))
table(dtest$diabetes, pred)
pred <- factor(ifelse(prob < .5, "neg", "pos"))
f <- lda(diabetes~age+glucose,data=dtrain)
grid <- expand.grid(
age = seq(0, 85, length = 100),
glucose = seq(50, 200, length = 100)
)
grid$prob <- predict(f, grid)$posterior[,"pos"]
ggplot(data=dtrain, aes(x=age, y=glucose)) +
geom_point(aes(color=diabetes),alpha=.5)+
geom_contour(data=grid,aes(z=prob),breaks=.5, color="black")
prob <- predict(f, newdata=dtest, type="response")
pred <- predict(f)$class
table(dtest$diabetes, pred)
pred
f <- lda(diabetes~age+glucose,data=dtrain)
grid <- expand.grid(
age = seq(0, 85, length = 100),
glucose = seq(50, 200, length = 100)
)
grid$prob <- predict(f, grid)$posterior[,"pos"]
ggplot(data=dtrain, aes(x=age, y=glucose)) +
geom_point(aes(color=diabetes),alpha=.5)+
geom_contour(data=grid,aes(z=prob),breaks=.5, color="black")
prob <- predict(f, newdata=dtest, type="response")
pred <- predict(f)$class
table(dtest$diabetes, pred)
f <- lda(diabetes~age+glucose,data=dtrain)
grid <- expand.grid(
age = seq(0, 85, length = 100),
glucose = seq(50, 200, length = 100)
)
grid$prob <- predict(f, grid)$posterior[,"pos"]
ggplot(data=dtrain, aes(x=age, y=glucose)) +
geom_point(aes(color=diabetes),alpha=.5)+
geom_contour(data=grid,aes(z=prob),breaks=.5, color="black")
prob <- predict(f, newdata=dtest)
pred <- predict(f)$class
table(dtest$diabetes, pred)
?predict.lda
prob <- predict(f, newdata=dtest)
pred <- predict(f)$class
table(dtest$diabetes, pred)
prob <- predict(f, newdata=dtrain)
pred <- predict(f)$class
table(dtest$diabetes, pred)
f <- lda(diabetes~age+glucose,data=dtrain)
grid <- expand.grid(
age = seq(0, 85, length = 100),
glucose = seq(50, 200, length = 100)
)
grid$prob <- predict(f, grid)$posterior[,"pos"]
ggplot(data=dtrain, aes(x=age, y=glucose)) +
geom_point(aes(color=diabetes),alpha=.5)+
geom_contour(data=grid,aes(z=prob),breaks=.5, color="black")
prob <- predict(f, newdata=dtest)
pred <- predict(f)$class
table(dtest$diabetes, pred)
length(prob)
length(pred)
length(dtest$diabetes)
pred <- predict(f)
head(pred)
summary(pred)
summary(d)
summary(dtest)
prob <- predict(f, newdata=dtest)$class
pred <- predict(f, newdata = dtest)$class
table(dtest$diabetes, pred)
f <- lda(diabetes~age+glucose,data=dtrain)
grid <- expand.grid(
age = seq(0, 85, length = 100),
glucose = seq(50, 200, length = 100)
)
grid$prob <- predict(f, grid)$posterior[,"pos"]
ggplot(data=dtrain, aes(x=age, y=glucose)) +
geom_point(aes(color=diabetes),alpha=.5)+
geom_contour(data=grid,aes(z=prob),breaks=.5, color="black")
pred <- predict(f, newdata = dtest)$class
table(dtest$diabetes, pred)
summary(f)
f <- qda(diabetes ~ age+glucose,data=dtrain)
grid <- expand.grid(
age = seq(0, 85, length = 100),
glucose = seq(50, 200, length = 100)
)
grid$pred <- predict(f, grid)$class
ggplot(data=dtest, aes(x=age, y=glucose,color=diabetes)) +
geom_point()+
geom_point(data=grid, aes(color=pred),size=.1)
f <- qda(diabetes ~ age+glucose,data=dtrain)
grid <- expand.grid(
age = seq(0, 85, length = 100),
glucose = seq(50, 200, length = 100)
)
grid$pred <- predict(f, grid)$class
ggplot(data=dtest, aes(x=age, y=glucose,color=diabetes)) +
geom_point()+
geom_point(data=grid, aes(color=pred),size=.1)
pred <- predict(f, newdata = dtest)$class
table(dtest$diabetes, pred)
head(dtrain)
head(dtrain[,2:8])
head(dtrain[,c(2,8)])
xdata <- scale(dtrain[,c(2,8)])
means <- attr(xdata, "scaled:center")
sds <- attr(xdata, "scaled:scale")
xdataTest <- scale(dtest[,c(2,8)], center = means, scale = sds)
pred <- knn(xdata, xdataTest, dtrain$diabetes,k=5)
table(dtest$diabetes, pred)
xdata <- scale(dtrain[,c(2,8)])
means <- attr(xdata, "scaled:center")
sds <- attr(xdata, "scaled:scale")
xdataTest <- scale(dtest[,c(2,8)], center = means, scale = sds)
pred5 <- knn(xdata, xdataTest, dtrain$diabetes,k=5)
pred30 <- knn(xdata, xdataTest, dtrain$diabetes,k=30)
table(dtest$diabetes, pred5)
table(dtest$diabetes, pred30)
grid <- expand.grid(
age = seq(0, 85, length = 100),
glucose = seq(50, 200, length = 100)
)
grids <- scale(grid, center=means, scale=sds)
grid$pred <- knn(xdata, grids, xtrain$diabetes, k=30)
ggplot(aes(x=age,y=glucose, color=pred), data=grid)+ geom_point(size=.3)
head(grid$pred)
grid$pred <- knn(xdata, grids, xtrain$diabetes, k=30)
grid <- expand.grid(
age = seq(0, 85, length = 100),
glucose = seq(50, 200, length = 100)
)
grids <- scale(grid, center=means, scale=sds)
grid$pred <- knn(xdata, grids, dtrain$diabetes, k=30)
ggplot(aes(x=age,y=glucose, color=pred), data=grid)+ geom_point(size=.3)
grid <- expand.grid(
age = seq(0, 85, length = 100),
glucose = seq(50, 200, length = 100)
)
grids <- scale(grid, center=means, scale=sds)
grid$pred <- knn(xdata, grids, dtrain$diabetes, k=30)
ggplot(data=dtrain, aes(x=age, y=glucose, color=diabetes))+
geom_point(size=1, shape=1, alpha=.3)+
geom_point(data=grid,aes(color=pred),alpha=.1)
grid <- expand.grid(
age = seq(0, 85, length = 100),
glucose = seq(50, 200, length = 100)
)
grids <- scale(grid, center=means, scale=sds)
grid$pred <- knn(xdata, grids, dtrain$diabetes, k=30)
ggplot(data=dtrain, aes(x=age, y=glucose, color=diabetes))+
geom_point(size=1, shape=1, alpha=.5)+
geom_point(data=grid,aes(color=pred),alpha=.3)
grid <- expand.grid(
age = seq(0, 85, length = 100),
glucose = seq(50, 200, length = 100)
)
grids <- scale(grid, center=means, scale=sds)
grid$pred <- knn(xdata, grids, dtrain$diabetes, k=30)
ggplot(data=dtrain, aes(x=age, y=glucose, color=diabetes))+
geom_point(size=1, shape=1, alpha=.5)+
geom_point(data=grid,aes(color=pred),alpha=.2)
xdata <- scale(dtrain[,c(2,8)])
means <- attr(xdata, "scaled:center")
sds <- attr(xdata, "scaled:scale")
xdataTest <- scale(dtest[,c(2,8)], center = means, scale = sds)
pred5 <- knn(xdata, xdataTest, dtrain$diabetes,k=5)
pred30 <- knn(xdata, xdataTest, dtrain$diabetes,k=30)
table(dtest$diabetes, pred5)
table(dtest$diabetes, pred30)
ggplot(data=Boston, aes(x=dis, y=nox))+ geom_point() +
geom_line(aes(y=fitted(f2)), color="red")
knitr::opts_chunk$set(echo = TRUE, fig.width=4, fig.height=4)
suppressMessages(library(MASS))
suppressMessages(library(gam))
library(splines)
library(ggplot2)
attr(bs(Boston$dis, df=4), "knots")
f1 <- lm(nox ~ bs(dis,df=4), data=Boston)
ggplot(data=Boston, aes(x=dis, y=nox))+ geom_point() +
geom_line(aes(y=fitted(f1)), color="red")
mse <- mean(f1$residuals^2)
mse
mse <- mean(residuals(f2)^2)
f2 <- smooth.spline(Boston$dis,Boston$nox, cv= TRUE)
ggplot(data=Boston, aes(x=dis, y=nox))+ geom_point() +
geom_line(aes(y=fitted(f2)), color="red")
mse <- mean(residuals(f2)^2)
mse
f3 <- smooth.spline(Boston$dis,Boston$nox, spar = 1)
f3 <- smooth.spline(Boston$dis,Boston$nox, spar = 1)
ggplot(data=Boston, aes(x=dis, y=nox))+ geom_point() +
geom_line(aes(y=fitted(f2)), color="red") + geom_line(aes(y=fitted(f3)), color="blue")
f3 <- smooth.spline(Boston$dis,Boston$nox, spar = 1)
ggplot(data=Boston, aes(x=dis, y=nox))+ geom_point() +
geom_line(aes(y=fitted(f2)), color="red") + geom_line(aes(y=fitted(f3)), color="blue")
mse <- mean(residuals(f3)^2)
mse
f4 <- lm(nox ~ ns(dis,4)+ ns(black,4) + ns(age,4), data=Boston1)
set.seed(1)
s <- sample(nrow(Boston), round(.6*nrow(Boston)))
Boston1 <- Boston[s,]
Boston2 <- Boston[-s,]
f4 <- lm(nox ~ ns(dis,4)+ ns(black,4) + ns(age,4), data=Boston1)
f4
f4$residuals
mse_train <- mean(f4$residuals^2)
mse_train
pred <- predict(f4, Boston2)
pred
pred <- predict(f4, Boston2)
mse_test <- mean((pred - Boston2$nox)^2)
mse_test
mse_train
plot.Gam(f4, terms = "ns(dis,4), ns(black,4), ns(age,4)")
plot.Gam(f4, terms = "ns(dis,4)")
suppressMessages(library(gam))
plot.Gam(f4, terms = "ns(dis,4)")
plot.Gam(f4, terms = "ns(dis, 4)")
suppressMessages(library(gam))
plot.Gam(f4, terms = "ns(dis, 4), ns(black, 4), ns(age, 4)")
suppressMessages(library(gam))
plot.Gam(f4, terms = "ns(dis, 4) + ns(black, 4) + ns(age, 4)")
suppressMessages(library(gam))
plot.Gam(f4, terms = "ns(dis, 4)")
plot.Gam(f4, terms = "ns(black, 4)")
plot.Gam(f4, terms = "ns(age, 4)")
plot.Gam(f4, terms = "ns(dis, 4)")
plot.Gam(f4, terms = "ns(black, 4)")
plot.Gam(f4, terms = "ns(age, 4)")
plot.Gam(f4, terms = "ns(dis, 4)")
f5 <- lm(nox ~ ns(dis,2)+ ns(black,2) + ns(age,2), data=Boston1)
anova(f4, f5)
anova(f5, f4)
anova(f4, f5)
plot.Gam(f4, terms = "ns(dis, 2)")
plot.Gam(f5, terms = "ns(dis, 2)")
plot.Gam(f5, terms = "ns(black, 2)")
plot.Gam(f5, terms = "ns(age, 2)")
mse_train <- mean(f5$residuals^2)
mse_train
pred <- predict(f5, Boston2)
mse_test <- mean((pred - Boston2$nox)^2)
mse_test
anova(f4, f5)
pchisq(0.025,20)
?pchisq
pchisq(0.975,20)
pchisq(0.975,20)
pchisq(0.975,20, lower.tail = FALSE)
pchisq(0.024,20, lower.tail = FALSE)
pchisq(0.025,20, lower.tail = FALSE)
pchisq(0.025,20, lower.tail = TRUE)
qchisq(0.025,20, lower.tail = TRUE)
qchisq(0.025,20, lower.tail = FALSE)
qchisq(0.975,20)
pchisq(0.025,20)
qchisq(0.025,20)
qchisq(0.975,20)
a <- qchisq(0.025,20)
b <- qchisq(0.975, 20)
20/b
20/a
pnorm(0,1, 0.05)
pnorm(0,1, 0.95)
?pnorm
qnorm(0.05,0,1)
qnorm(0.95,0,1)
pnorm(-3.3559,0,1)
qnorm(0.95,0,1, lower.tail = FALSE)
?qchisq
qchisq(0.95, 14)
install.packages("blogdown")
blogdown::install_hugo()
setwd("C:/Users/35383/Exercism/r/hello-world")
